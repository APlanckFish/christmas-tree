# 端口配置说明

## 默认端口

为了避免网络策略限制（如防火墙、公司网络等），项目已使用更大的端口号：

- **HTTP 服务器（前端）**: `8080` (原 5173)
- **WebSocket 服务器（信令）**: `8081` (原 3001)
- **生产环境**: `8080` (原 3000)

## 配置方式

### 方式一：环境变量（推荐）

创建 `.env` 文件（参考 `.env.example`）：

```bash
# HTTP 服务器端口
VITE_HTTP_PORT=8080

# WebSocket 服务器端口
WS_PORT=8081

# 生产环境端口
PORT=8080
```

### 方式二：运行时指定

```bash
# 开发环境
WS_PORT=8081 VITE_HTTP_PORT=8080 npm run dev

# 或使用快捷命令
npm run dev:custom
```

### 方式三：UI 配置（仅 WebSocket 端口）

在 PC 端连接手机摄像头时，可以在二维码弹窗中配置 WebSocket 端口，配置会保存到 localStorage。

## 端口范围建议

如果遇到网络限制，可以尝试以下端口范围：

- **8000-8999**: 通常不受限制
- **9000-9999**: 备用范围
- **10000-10999**: 高端口范围

## 检查端口占用

```bash
# macOS/Linux
lsof -i :8080
lsof -i :8081

# Windows
netstat -ano | findstr :8080
netstat -ano | findstr :8081
```

## 防火墙配置

如果使用防火墙，需要开放以下端口：

- HTTP 端口（默认 8080）
- WebSocket 端口（默认 8081）

## 常见问题

### Q: 连接失败，提示端口被占用？

A: 检查端口占用情况，或修改 `.env` 文件使用其他端口。

### Q: 手机无法连接到 PC？

A: 确保：
1. PC 和手机在同一网络
2. 防火墙允许端口访问
3. 使用 PC 的局域网 IP（非 localhost）
4. WebSocket 端口配置正确

### Q: 如何查看当前使用的端口？

A: 查看控制台输出，或检查浏览器 Network 标签中的 WebSocket 连接。

